{"project":{"profile":{"name":"multivac_trm_dia","description":"Robot para obtener la TRM del día"},"commands":[{"father":"module","command":"{\"module_name\":\"System++\",\"module\":\"cleanVars\",\"vars\":\"url_trm_dia,indice_variable,xpath_trm_dia,disponible,trm_dia,xpath_iframe_trm,log_file\"}","option":"","var":"","index":0,"group":"scripts","execute":2,"if":"","children":[],"else":[],"id":"1c4113f0-5e57-c55c-37ed-ec544d0d9a8d","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"module  {\"module_name\":\"System++\",\"module\":\"cleanVars\",\"vars\":\"url_trm_dia,indice_variable,xpath_trm_dia,disponible,trm_dia,xpath_iframe_trm,log_file\"}","extra":[],"result":"True","description":"Limpar las variables usadas en este robot"},{"father":"setVar","command":"False","option":"","var":"global_resultado_exec_robot","index":1,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"1d62ba7c-f408-70ae-cdae-2eaddedf8c9a","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['usuario_fs'], ['nombre_robot'], ['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_fecha_final'], ['xpath_aceptar'], ['xpath_exportar'], ['xpath_exportar_excel'], ['fecha_inicial_informe']].index(['url_trm_dia'])","extra":[],"result":"True","disabled":false,"description":"Inicia esta variable en False, se cambia a True solo si se llega hasta el final sin errores"},{"father":"setVar","command":"{variables_conf}.index(['path_dir_logs'])","option":"","var":"indice_variable","index":2,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"528b1aad-febd-ebaa-b212-73b365a65528","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['usuario_fs'], ['nombre_robot'], ['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_fecha_final'], ['xpath_aceptar'], ['xpath_exportar'], ['xpath_exportar_excel'], ['fecha_inicial_informe']].index(['url_trm_dia'])","extra":[],"result":"True","disabled":false,"description":"Se obtiene el índice de la variable path_dir_logs"},{"father":"setVar","command":"{valores_conf}[{indice_variable}][0] + \"/log.txt\"","option":"","var":"log_file","index":3,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"5a34be77-19e7-3fb4-9769-d0eaae70b4bc","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","disabled":false,"message":"setvar  [['jmunoz-hp'], ['robot'], ['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['//*[@id=\"saw_1553152_3_2_D\"]'], ['//*[@id=\"gobtn\"]'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[2]/table/tbody/tr/td[2]'], ['\"01/01/2015\"']][8][0]","extra":[],"result":"True","description":"Se establece la variable a la ruta completa del archivo de log"},{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":4,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"e201615e-6b90-6dd8-a410-831d65d8dd49","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","disabled":false,"message":"setvar  [['jmunoz-hp'], ['robot'], ['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['//*[@id=\"saw_1553152_3_2_D\"]'], ['//*[@id=\"gobtn\"]'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[2]/table/tbody/tr/td[2]'], ['\"01/01/2015\"']][8][0]","extra":[],"result":"True","description":"Se establece una marca de tiempo para escribir el log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"=======O=======\\n{marca_tiempo_log}: Ahora estoy ejecutando el robot multivac_trm_dia\"}","option":"","var":"","index":5,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"8d94a9bd-fa1f-9046-b725-6f8eba53df23","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe el log"},{"father":"setVar","command":"{variables_conf}.index(['url_trm_dia'])","option":"","var":"indice_variable","index":6,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"fec1215f-3bc5-7542-32f1-a2c64229cb09","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['usuario_fs'], ['nombre_robot'], ['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_fecha_final'], ['xpath_aceptar'], ['xpath_exportar'], ['xpath_exportar_excel'], ['fecha_inicial_informe']].index(['url_trm_dia'])","extra":[],"result":"True","disabled":false,"description":"Se obtiene el índice de la variable url_trm_dia. variables_conf está definida en robot padre"},{"father":"setVar","command":"{valores_conf}[{indice_variable}][0]","option":"","var":"url_trm_dia","index":7,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"92195b51-3301-1a2a-566a-60cf2a8e873f","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","disabled":false,"message":"setvar  [['jmunoz-hp'], ['robot'], ['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['//*[@id=\"saw_1553152_3_2_D\"]'], ['//*[@id=\"gobtn\"]'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[2]/table/tbody/tr/td[2]'], ['\"01/01/2015\"']][8][0]","extra":[],"result":"True","description":"Se estblece la variable url_trm_dia"},{"father":"setVar","command":"{variables_conf}.index(['xpath_trm_dia'])","option":"","var":"indice_variable","index":8,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"a4d4658a-5961-7a10-0ae6-a1e8135cf588","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['usuario_fs'], ['nombre_robot'], ['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_fecha_final'], ['xpath_aceptar'], ['xpath_exportar'], ['xpath_exportar_excel'], ['fecha_inicial_informe']].index(['xpath_trm_dia'])","extra":[],"result":"True","disabled":false,"description":"Se obtiene el índice de la variable xpath_trm_dia"},{"father":"setVar","command":"{valores_conf}[{indice_variable}][0]","option":"","var":"xpath_trm_dia","index":9,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"fb351658-cf3b-1b18-3494-4d8a7b1d26c5","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","disabled":false,"message":"setvar  [['jmunoz-hp'], ['robot'], ['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['//*[@id=\"saw_1553152_3_2_D\"]'], ['//*[@id=\"gobtn\"]'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[2]/table/tbody/tr/td[2]'], ['\"01/01/2015\"']][11][0]","extra":[],"result":"True","description":"Se establece la variable xpath_trm_dia"},{"father":"setVar","command":"{variables_conf}.index(['xpath_iframe_trm'])","option":"","var":"indice_variable","index":10,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"87f07441-cac6-93c3-8937-e5c848e15433","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['usuario_fs'], ['nombre_robot'], ['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_fecha_final'], ['xpath_aceptar'], ['xpath_exportar'], ['xpath_exportar_excel'], ['fecha_inicial_informe']].index(['xpath_iframe_trm'])","extra":[],"result":"True","disabled":false,"description":"Se obtiene el índice de la variable xpath_iframe_trm"},{"father":"setVar","command":"{valores_conf}[{indice_variable}][0]","option":"","var":"xpath_iframe_trm","index":11,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"0be3268b-b867-6ab5-cf77-a2cf450f3b29","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","disabled":false,"message":"setvar  [['jmunoz-hp'], ['robot'], ['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['//*[@id=\"saw_1553152_3_2_D\"]'], ['//*[@id=\"gobtn\"]'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[2]/table/tbody/tr/td[2]'], ['\"01/01/2015\"']][10][0]","extra":[],"result":"True","description":"Se establece la variable xpath_iframe_trm"},{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":12,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"10cc9bc0-80e1-5065-4d06-73792cf80545","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","disabled":false,"message":"setvar  [['jmunoz-hp'], ['robot'], ['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['//*[@id=\"saw_1553152_3_2_D\"]'], ['//*[@id=\"gobtn\"]'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[2]/table/tbody/tr/td[2]'], ['\"01/01/2015\"']][8][0]","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir el log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Abriendo navegador chrome url_trm_dia = {url_trm_dia}\"}","option":"","var":"","index":13,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"4c912a64-a512-eca5-394a-222b4e61eeb9","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe el log"},{"father":"use","command":"{\"tipo\":\"0\",\"url\":\"{url_trm_dia}\"}","option":"chrome","var":"","index":14,"group":"web","execute":2,"if":"","children":[],"else":[],"id":"61153a71-b636-39e8-fdc8-6bc797a3ed44","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","data_":{"tipo":"0","url":"{url_trm_dia}"},"execute_debbug":0,"img":"","message":"use chrome {\"tipo\":\"0\",\"url\":\"https://www.banrep.gov.co/\"}","extra":[],"result":"True","description":"Se abre el navegador chrome"},{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":15,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"b9333269-b178-ac0b-3438-55b5d4737094","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","disabled":false,"message":"setvar  [['jmunoz-hp'], ['robot'], ['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['//*[@id=\"saw_1553152_3_2_D\"]'], ['//*[@id=\"gobtn\"]'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[2]/table/tbody/tr/td[2]'], ['\"01/01/2015\"']][8][0]","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir el archivo de log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Esperando por el iframe que contiene el valor de la TRM del día xpath_iframe_trm = {xpath_iframe_trm}\"}","option":"","var":"","index":16,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"38ad9186-1064-d039-ca57-aa9000eff1e3","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe archivo de log"},{"father":"waitforobject","command":"{\"object\":\"{xpath_iframe_trm}\",\"wait_for\":\"visible\",\"wait_time\":\"60\",\"before\":0,\"after\":0}","option":"xpath","var":"","index":17,"group":"web","execute":2,"if":"","children":[],"else":[],"id":"0a921bca-afbf-5bbb-3822-8a83dc6fdab1","mode_live":true,"getvar":"disponible","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"waitforobject xpath {\"object\":\"{xpath_iframe_trm}\",\"wait_for\":\"visible\",\"wait_time\":\"60\",\"before\":0,\"after\":0}","extra":[],"result":"True","description":"Se espera a qué esté disponible el iframe en donde está el valor de la TRM del día"},{"father":"evaluateIf","command":"{disponible}","option":"","var":"","index":18,"group":"logic","execute":2,"if":"","children":[{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":0,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"ecbf8e47-28ff-4eb1-ba8d-16661bcab8c9","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","disabled":false,"message":"setvar  [['jmunoz-hp'], ['robot'], ['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['//*[@id=\"saw_1553152_3_2_D\"]'], ['//*[@id=\"gobtn\"]'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[2]/table/tbody/tr/td[2]'], ['\"01/01/2015\"']][8][0]","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir el log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Cambiando a iframe xpath_iframe_trm = {xpath_iframe_trm}\"}","option":"","var":"","index":1,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"0abd94bb-bf14-3303-85fa-f4795045e43a","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe el log"},{"father":"swichtoframe","command":"{xpath_iframe_trm}","option":"xpath","var":"","index":2,"group":"web","execute":2,"if":"","children":[],"else":[],"id":"1647671e-fe06-9ded-6ebf-2cee9d1f853f","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"swichtoframe xpath /html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe","extra":[],"result":"True","disabled":false,"description":"Se cambia al iframe en donde está la TRM del día"},{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":3,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"4228a6f5-6e94-08fa-8dea-966f31df9e3b","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","disabled":false,"message":"setvar  [['jmunoz-hp'], ['robot'], ['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['//*[@id=\"saw_1553152_3_2_D\"]'], ['//*[@id=\"gobtn\"]'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[2]/table/tbody/tr/td[2]'], ['\"01/01/2015\"']][8][0]","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir el log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Esperando objeto en donde está el valor de la TRM del día xpath_trm_dia = {xpath_trm_dia}\"}","option":"","var":"","index":4,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"1db55b21-34c4-d948-12d0-8cc0b7985964","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe el log"},{"father":"waitforobject","command":"{\"object\":\"{xpath_trm_dia}\",\"wait_for\":\"visible\",\"wait_time\":\"60\",\"before\":0,\"after\":0}","option":"xpath","var":"","index":5,"group":"web","execute":2,"if":"","children":[],"else":[],"id":"ebca6ad0-d3c1-998f-d3ed-f17586eb590a","mode_live":true,"getvar":"disponible","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"waitforobject xpath {\"object\":\"{xpath_trm_dia}\",\"wait_for\":\"visible\",\"wait_time\":\"60\",\"before\":0,\"after\":0}","extra":[],"result":"True","description":"Se espera por el objeto que tiene el valor de la TRM del día"},{"father":"evaluateIf","command":"{disponible}","option":"","var":"","index":6,"group":"logic","execute":2,"if":"","children":[{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":0,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"d48e6ed2-af7f-fc58-e309-c83a7b5abd63","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","disabled":false,"message":"setvar  [['jmunoz-hp'], ['robot'], ['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['//*[@id=\"saw_1553152_3_2_D\"]'], ['//*[@id=\"gobtn\"]'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[2]/table/tbody/tr/td[2]'], ['\"01/01/2015\"']][8][0]","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir el archivo de log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Obteniendo el valor de la TRM en xpath_trm_dia = {xpath_trm_dia}\"}","option":"","var":"","index":1,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"bc254d94-4ed9-ff57-e7f1-5c96a9f164fb","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe archivo de log"},{"father":"textObject","command":"{xpath_trm_dia}","option":"xpath","var":"","index":2,"group":"web","execute":2,"if":"","children":[],"else":[],"id":"ac9d9491-fda4-c9d6-c5bb-d40b38c31a76","mode_live":true,"getvar":"trm_dia","screenshot":"","execute_debbug":0,"img":"","description":"Se extrae el valor de la TRM del día"},{"father":"setVar","command":"\"{trm_dia}\".decode()","option":"","var":"trm_dia","index":3,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"cba16a25-91bf-8244-1f49-c1b84beca87e","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"setvar  b'3.847,4'.decode()","extra":[],"result":"True","disabled":false,"description":"Se establece la variable con el valor de la TRM del día. Se reemplazan las comas por los puntos"},{"father":"setVar","command":"\"{trm_dia}\".replace(\".\",\"\")","option":"","var":"trm_dia","index":4,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"a81f62fa-8f12-53b4-d677-091f163a7a74","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"setvar  b'3.847,4'.decode()","extra":[],"result":"True","disabled":false,"description":"Se quitan los puntos como separadores de miles"},{"father":"setVar","command":"\"{trm_dia}\".replace(\",\",\".\")","option":"","var":"trm_dia","index":5,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"724c2f1d-1c5f-d44f-d4d9-044de91594fd","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"setvar  b'3.847,4'.decode()","extra":[],"result":"True","disabled":false,"description":"Se reemplazand las comas por punto como separador decimal"},{"father":"setVar","command":"{trm_dia}","option":"","var":"global_trm_dia","index":6,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"ebb36648-01fb-4219-dcc0-09c59d723288","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"setvar  3.847,4","extra":[],"result":"True","description":"Se establece esta variable global que está definida en el robot multivac_inicializacion con el valor de la TRM"},{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":7,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"b2b20856-cb0c-a7d3-c405-5a1ff7cf4b56","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","disabled":false,"message":"setvar  [['jmunoz-hp'], ['robot'], ['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['//*[@id=\"saw_1553152_3_2_D\"]'], ['//*[@id=\"gobtn\"]'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[2]/table/tbody/tr/td[2]'], ['\"01/01/2015\"']][8][0]","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir el log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Valor de la trm obtenido {trm_dia}\"}","option":"","var":"","index":8,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"c36f789f-7e55-02e1-3269-fbf5f95915b1","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe archivo de log"},{"father":"setVar","command":"True","option":"","var":"global_resultado_exec_robot","index":9,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"d3678425-dff0-3a99-5b90-ed30b24cac15","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","description":"Se se llegó a este punto, se establece esta variable de multivac_inicializacion en True para que sea verificada allá"}],"else":[{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":0,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"b050c15c-5e0a-7c53-67a3-c8ba0422e1e1","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","disabled":false,"message":"setvar  [['jmunoz-hp'], ['robot'], ['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['//*[@id=\"saw_1553152_3_2_D\"]'], ['//*[@id=\"gobtn\"]'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[2]/table/tbody/tr/td[2]'], ['\"01/01/2015\"']][8][0]","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: No se pudo encontrar el objeto en donde está el valor de la TRM del día xpath_trm_dia = {xpath_trm_dia}\"}","option":"","var":"","index":1,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"ac326053-7185-1332-56b2-968a033f1b71","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe log"}],"id":"13468947-0110-8669-30b0-1b80a9a05f7a","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","minimize_else":false,"execute_debbug":0,"img":"","message":"evaluateif  True","extra":{"res":"True"},"result":"True","minimize":false,"description":"Si el objeto esperado está disponible..."}],"else":[{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":0,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"1e62947e-f370-608a-b6a0-02f299ddc3f1","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","disabled":false,"message":"setvar  [['jmunoz-hp'], ['robot'], ['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['//*[@id=\"saw_1553152_3_2_D\"]'], ['//*[@id=\"gobtn\"]'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[2]/table/tbody/tr/td[2]'], ['\"01/01/2015\"']][8][0]","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: No se encontró el objeto xpath_iframe_trm = {xpath_iframe_trm} cerrando navegador y terminando robot multivac_trm_dia\"}","option":"","var":"","index":1,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"af14cfe6-0419-e181-3e0d-f96f2edd6917","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe log"}],"id":"5f270f27-4d74-5dec-5bed-fde905c0cb1e","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"evaluateif  True","extra":{"res":"True"},"result":"True","minimize_else":false,"minimize":false,"description":"Si el iframe esperado se encuentra disponible..."},{"father":"killdriver","command":"","option":"","var":"","index":19,"group":"web","execute":2,"if":"","children":[],"else":[],"id":"2c4ffb15-0689-645a-15fb-a6d6e8138172","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"killdriver  ","extra":[],"result":"True","description":"Se cierra el navegador"},{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":20,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"bac90045-ca25-3c1b-bb3a-19ea00eb2077","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","disabled":false,"message":"setvar  [['jmunoz-hp'], ['robot'], ['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['//*[@id=\"saw_1553152_3_2_D\"]'], ['//*[@id=\"gobtn\"]'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[2]/table/tbody/tr/td[2]'], ['\"01/01/2015\"']][8][0]","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Ejecución finalizada de multivac_trm_dia global_resultado_exec_robot = {global_resultado_exec_robot}\"}","option":"","var":"","index":21,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"4d94c35c-d9b2-c402-d287-b6909e23f09f","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe log"}],"vars":[{"name":"url_trm_dia","data":"","type":"string","collapse":true,"$$hashKey":"object:462"},{"name":"indice_variable","data":"","type":"string","collapse":true,"$$hashKey":"object:463"},{"name":"xpath_trm_dia","data":"","type":"string","collapse":true,"$$hashKey":"object:464"},{"name":"disponible","data":"","type":"string","collapse":true,"$$hashKey":"object:465"},{"name":"trm_dia","data":"","type":"string","collapse":true,"$$hashKey":"object:466"},{"name":"xpath_iframe_trm","data":"","type":"string","collapse":true,"$$hashKey":"object:467"},{"name":"log_file","data":"","type":"string","collapse":true,"$$hashKey":"object:468"},{"name":"marca_tiempo_log","data":"","type":"string","collapse":true,"$$hashKey":"object:469"}],"ifs":[{"id":"22be0bec-e03d-eccb-7c65-73ae05ad0462","status":null},{"id":"872fe4d1-6ef0-185e-baa7-bc09d58a5a97","status":null},{"id":"96636a07-9a6b-3a94-4203-ad4a8c717473","status":null}]}}