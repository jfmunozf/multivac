{"project":{"profile":{"name":"multivac_escribir_excel","description":"Robot para escrbir el reporte del análisis TRM en Excel"},"commands":[{"father":"module","command":"{\"module_name\":\"System++\",\"module\":\"cleanVars\",\"vars\":\"resultado,marca_tiempo,nombre_archivo,full_path,indice_variable,path_dir_trazabilidad,encabezado,log_file,marca_tiempo_log,fecha_inicial_informe,fecha_final_informe,trm_dia,texto_celda,log_file,marca_tiempo_log,ultimo_estado\"}","option":"","var":"","index":0,"group":"scripts","execute":2,"if":"","children":[],"else":[],"id":"122c59ec-de6a-1cb3-2237-83e046c56d88","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"module  {\"module_name\":\"System++\",\"module\":\"cleanVars\",\"vars\":\"resultado,marca_tiempo,nombre_archivo,full_path,indice_variable,path_dir_trazabilidad,encabezado,log_file,marca_tiempo_log,fecha_inicial_informe,fecha_final_informe,trm_dia,texto_celda\"}","extra":[],"result":"True","disabled":false,"description":"Se limpian las variables locales que usa este robot"},{"father":"setVar","command":"False","option":"","var":"global_resultado_exec_robot","index":1,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"f96be403-609a-625c-2a3f-aae0c592454b","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  datetime.now().strftime(\"%Y_%m_%d_%H_%M_%S\")","extra":[],"result":"True","description":"Se establece a False variable global con la que se controla si el robot terminó correctamente"},{"father":"setVar","command":"{variables_conf}.index(['path_dir_logs'])","option":"","var":"indice_variable","index":2,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"753eb716-85bb-da3d-de06-cdc08b9b2e4a","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  datetime.now().strftime(\"%Y_%m_%d_%H_%M_%S\")","extra":[],"result":"True","description":"Obtener el indice de la variable path_dir_logs"},{"father":"setVar","command":"{valores_conf}[{indice_variable}][0] + \"/log.txt\"","option":"","var":"log_file","index":3,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"9a0e5a00-926f-fe47-c984-fb2f6e2cc7cd","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  datetime.now().strftime(\"%Y_%m_%d_%H_%M_%S\")","extra":[],"result":"True","description":"Establecer la ruta completa del archivo de log"},{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":4,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"40bfaf26-f4c8-6e3d-e36b-f506d5998510","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  datetime.now().strftime(\"%Y_%m_%d_%H_%M_%S\")","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir el archivo de log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"=======O=======\\n{marca_tiempo_log}: Ahora estoy ejecutando el robot multivac_escribir_excel\"}","option":"","var":"","index":5,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"501384dd-c087-31bf-c0bb-302aaae655c8","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe el archivo de log"},{"father":"setVar","command":"datetime.now().strftime(\"%Y_%m_%d_%H_%M_%S\")","option":"","var":"marca_tiempo","index":6,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"045ba4b9-31f2-37fe-11d6-7a4dc0358ac7","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  datetime.now().strftime(\"%Y_%m_%d_%H_%M_%S\")","extra":[],"result":"True","description":"Se establece marca de tiempo para generar el nombre del archivo del reporte"},{"father":"setVar","command":"\"{marca_tiempo}\"+\".xlsx\"","option":"","var":"nombre_archivo","index":7,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"38400910-b564-8628-00db-1fdbcd5b0ce7","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  \"2021_11_07_11_17_38\"+\".xlsx\"","extra":[],"result":"True","description":"Se establece el nombre del archivo con la marca de tiempo y extensión xlsx"},{"father":"setVar","command":"{variables_conf}.index(['path_dir_trazabilidad'])","option":"","var":"indice_variable","index":8,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"d4a45eac-f607-f3e6-e5b3-a2dd6f3279f0","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['fecha_inicial_informe'], ['fecha_final_informe'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_boton_aceptar'], ['xpath_link_exportar'], ['xpath_exportar_datos'], ['xpath_exportar_csv'], ['path_dir_recibidos'], ['path_dir_logs'], ['path_dir_trazabilidad']].index(['path_dir_trazabilidad'])","extra":[],"result":"True","description":"Se obtiene el índice de la variable de configuración path_dir_trazabilidad"},{"father":"setVar","command":"{valores_conf}[{indice_variable}][0]","option":"","var":"path_dir_trazabilidad","index":9,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"8d04ab5f-b09f-f53b-d317-0403787623d5","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['\"01/01/2015\"'], ['\"06/11/2021\"'], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[5]/td/input'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[5]'], ['/html/body/div[2]/table/tbody/tr[1]/td[1]/a[2]'], ['C:/Users/jmunoz-hp/Documents/robot/Recibidos'], ['C:/Users/jmunoz-hp/Documents/robot/Logs'], ['C:/Users/jmunoz-hp/Documents/robot/Trazabilidad']][20][0]","extra":[],"result":"True","description":"Se establece el valor de la variable path_dir_trazabilidad"},{"father":"setVar","command":"\"{path_dir_trazabilidad}\" + \"/\" + \"{nombre_archivo}\"","option":"","var":"full_path","index":10,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"173b9ea0-b6e9-7214-6aeb-0188ad027069","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  \"C:/Users/jmunoz-hp/Documents/robot/Trazabilidad\" + \"/\" + \"2021_11_07_11_17_38.xlsx\"","extra":[],"result":"True","description":"Se establece la ruta completa al archivo del reporte"},{"father":"setVar","command":"{global_trm_dia}","option":"","var":"trm_dia","index":11,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"958aeaf2-b5e6-537a-c5bc-6e4e707d85bf","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  2000","extra":[],"result":"True","description":"Se obtiene la variable global de la TRM del día"},{"father":"setVar","command":"{variables_conf}.index(['fecha_inicial_informe'])","option":"","var":"indice_variable","index":12,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"db160dd5-5ac7-dca4-68ac-f2b9a0fe7697","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['fecha_inicial_informe'], ['fecha_final_informe'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_boton_aceptar'], ['xpath_link_exportar'], ['xpath_exportar_datos'], ['xpath_exportar_csv'], ['path_dir_recibidos'], ['path_dir_logs'], ['path_dir_trazabilidad']].index(['fecha_inicial_informe'])","extra":[],"result":"True","description":"Se obtiene el índice de la variable de configuración fecha_inicial_informe"},{"father":"setVar","command":"{valores_conf}[{indice_variable}][0]","option":"","var":"fecha_inicial_informe","index":13,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"a4f05444-13da-2457-ecf2-14bc7cf8f6f9","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['\"01/01/2015\"'], ['\"06/11/2021\"'], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[5]/td/input'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[5]'], ['/html/body/div[2]/table/tbody/tr[1]/td[1]/a[2]'], ['C:/Users/jmunoz-hp/Documents/robot/Recibidos'], ['C:/Users/jmunoz-hp/Documents/robot/Logs'], ['C:/Users/jmunoz-hp/Documents/robot/Trazabilidad']][8][0]","extra":[],"result":"True","description":"Se estabkece el valor de la fecha incicial del informe"},{"father":"setVar","command":"{variables_conf}.index(['fecha_final_informe'])","option":"","var":"indice_variable","index":14,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"8a23c5b5-ddaa-9237-653e-3c03f33c1419","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['fecha_inicial_informe'], ['fecha_final_informe'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_boton_aceptar'], ['xpath_link_exportar'], ['xpath_exportar_datos'], ['xpath_exportar_csv'], ['path_dir_recibidos'], ['path_dir_logs'], ['path_dir_trazabilidad']].index(['fecha_final_informe'])","extra":[],"result":"True","description":"Se obtiene el indice de la variable de configuración fecha_final_informe"},{"father":"setVar","command":"{valores_conf}[{indice_variable}][0]","option":"","var":"fecha_final_informe","index":15,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"0d249afb-29e7-81f9-fd2e-5cfbeb93da31","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['\"01/01/2015\"'], ['\"06/11/2021\"'], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[5]/td/input'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[5]'], ['/html/body/div[2]/table/tbody/tr[1]/td[1]/a[2]'], ['C:/Users/jmunoz-hp/Documents/robot/Recibidos'], ['C:/Users/jmunoz-hp/Documents/robot/Logs'], ['C:/Users/jmunoz-hp/Documents/robot/Trazabilidad']][9][0]","extra":[],"result":"True","description":"Se establece el valor de la fecha final del informe"},{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":16,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"2d59ad19-6531-0b6a-334a-d638b09d4de2","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  datetime.now().strftime(\"%Y_%m_%d_%H_%M_%S\")","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir el archivo de log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Robot multivac_escribir_excel inicializado con las siguientes variables marca_tiempo = {marca_tiempo}, path_dir_trazabilidad = {path_dir_trazabilidad}, trm_dia = {trm_dia}, fecha_inicial_informe = {fecha_inicial_informe}, fecha_final_informe = {fecha_final_informe}\"}","option":"","var":"","index":17,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"e901830b-cf09-03b0-078e-09ec18bcf0dd","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe archivo de log"},{"father":"trycatch","command":"{}","option":"","var":"","index":18,"group":"logic","execute":2,"if":"","children":[{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":0,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"65a591e1-e55e-6241-d734-45fed2a192ba","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  datetime.now().strftime(\"%Y_%m_%d_%H_%M_%S\")","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir el archivo de log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Abriendo excel para generar el informe\"}","option":"","var":"","index":1,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"b97601dc-4cbd-f889-f8b3-b68f962500c8","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe el archivo de log"},{"father":"setVar","command":"False","option":"","var":"resultado","index":2,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"5994b420-abd1-4f79-bb16-5608708c40f9","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  datetime.now().strftime(\"%Y_%m_%d_%H_%M_%S\")","extra":[],"result":"True","description":"Se establece en False la variable que permite saber si Excel se abrió"},{"father":"newxlsx","command":"","option":"","var":"","index":3,"group":"excel","execute":2,"if":"","children":[],"else":[],"id":"19b50721-82ed-000b-9fa6-88133512ad22","mode_live":true,"getvar":"resultado","screenshot":"","execute_debbug":0,"img":"","message":"newxlsx  ","extra":true,"result":"True","description":"Se crea un nuevo libro de Excel"},{"father":"evaluateIf","command":"{resultado}","option":"","var":"","index":4,"group":"logic","execute":2,"if":"","children":[{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":0,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"e94fca44-568d-88e4-971c-3b401f283b9a","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  datetime.now().strftime(\"%Y_%m_%d_%H_%M_%S\")","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir el log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Excel se abrió con éxito, escribiendo información al archivo\"}","option":"","var":"","index":1,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"6f7f68bb-3a74-94b2-493a-d72321c5fb0b","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe archivo de log"},{"father":"setcell","command":"A1=Fecha inicial","option":"","var":"","index":2,"group":"excel","execute":2,"if":"","children":[],"else":[],"id":"cb93407c-9149-ab51-48f5-6bd57bcbd234","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setcell  A1=Fecha inicial","extra":false,"result":"True","description":"Se escribe el texto en celda"},{"father":"setcell","command":"B1={fecha_inicial_informe}","option":"","var":"","index":3,"group":"excel","execute":2,"if":"","children":[],"else":[],"id":"06ea1d7c-ec6b-fb54-00c9-87a4138d375f","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setcell  B1={fecha_inicial_informe}","extra":false,"result":"True","description":"Se escribe en celda la fecha inicial del informe"},{"father":"setcell","command":"A2=Fecha final","option":"","var":"","index":4,"group":"excel","execute":2,"if":"","children":[],"else":[],"id":"abafb4bf-fa8b-ae4f-80d8-cc9ad1eb4bc2","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setcell  A2=Fecha final","extra":false,"result":"True","description":"Se escribe texto en celda"},{"father":"setcell","command":"B2={fecha_final_informe}","option":"","var":"","index":5,"group":"excel","execute":2,"if":"","children":[],"else":[],"id":"ff2426a5-149e-6efb-5428-b23082a4c382","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setcell  B2={fecha_final_informe}","extra":false,"result":"True","description":"Se escribe en celda la fecha final del informe"},{"father":"setVar","command":"\"TRM para el día \" + datetime.now().strftime(\"%Y-%m-%d\")","option":"","var":"texto_celda","index":6,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"71fa383a-c34a-581c-ae07-a5aeb14d7c55","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  \"TRM para el día \" + datetime.now().strftime(\"%Y-%m-%d\")","extra":[],"result":"True","description":"Se establece el texto que se va a escriobir en la celda A3"},{"father":"setcell","command":"A3={texto_celda}","option":"","var":"","index":7,"group":"excel","execute":2,"if":"","children":[],"else":[],"id":"fd78a111-b5a7-244e-8455-e6316b6f2f06","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setcell  A3={texto_celda}","extra":false,"result":"True","description":"Se escribe texto en celda"},{"father":"setcell","command":"B3={global_trm_dia}","option":"","var":"","index":8,"group":"excel","execute":2,"if":"","children":[],"else":[],"id":"9eb4b686-c05d-f1b3-2f97-a804f3516f59","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setcell  B3={global_trm_dia}","extra":false,"result":"True","description":"Se escribe valor de la TRM del día. Variable global_trm_dia viene desde el robot padre"},{"father":"setcell","command":"A5=Datos generales","option":"","var":"","index":9,"group":"excel","execute":2,"if":"","children":[],"else":[],"id":"59122162-e0f7-82c3-b803-fcdf00e469e6","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setcell  A5=Datos generales","extra":false,"result":"True","description":"Se escribe texto en celda"},{"father":"setVar","command":"[{\"A6\":\"Valor Máx\", \"B6\":\"Valor Min\", \"C6\":\"Promedio\"}]","option":"","var":"encabezado","index":10,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"5b790db4-ff3e-67e0-b13e-cbb27858537c","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"setvar  [{\"A6\":\"Valor Máx\", \"B6\":\"Valor Min\", \"C6\":\"Promedio\"}]","extra":[],"result":"True","description":"Se escribe el diccionario de datos generales como encabezado de las columnas"},{"father":"module","command":"{\"module_name\":\"AdvancedExcel\",\"module\":\"write_cell\",\"sheet\":\"Hoja1\",\"range\":\"A6\",\"data\":\"{encabezado}\"}","option":"","var":"","index":11,"group":"scripts","execute":2,"if":"","children":[],"else":[],"id":"5ed91bcd-57d9-3180-cb15-9a596c6f4917","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"module  {\"module_name\":\"AdvancedExcel\",\"module\":\"write_cell\",\"sheet\":\"Hoja1\",\"range\":\"A6\",\"data\":\"{encabezado}\"}","extra":[],"result":"True","disabled":false,"description":"Se escribe el diccionario con los datos que corresponden al encabzado de datos generales"},{"father":"module","command":"{\"module_name\":\"AdvancedExcel\",\"module\":\"write_cell\",\"sheet\":\"Hoja1\",\"range\":\"A7\",\"data\":\"{global_datos_generales}\"}","option":"","var":"","index":12,"group":"scripts","execute":2,"if":"","children":[],"else":[],"id":"fcfa9392-ae24-96f2-97d9-649e198d67a2","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"module  {\"module_name\":\"AdvancedExcel\",\"module\":\"write_cell\",\"sheet\":\"Hoja1\",\"range\":\"A7\",\"data\":\"{global_datos_generales}\"}","extra":[],"result":"True","disabled":false,"description":"Se escriben los datos generales obtenidos. Variable global_datos_generales viene desde el robot padre"},{"father":"setcell","command":"A9=Datos específicos","option":"","var":"","index":13,"group":"excel","execute":2,"if":"","children":[],"else":[],"id":"d2454e1f-08eb-5fc2-83ac-17e2d8932800","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setcell  A9=Datos específicos","extra":false,"result":"True","description":"Se escribe texto en celda"},{"father":"setVar","command":"[{\"A10\":\"Año\", \"B10\":\"Valor Máx\", \"C10\":\"Valor Min\", \"D10\":\"Promedio\", \"E10\":\"Mes Máx\", \"F10\":\"Mes Min\"}]","option":"","var":"encabezado","index":14,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"f6350692-8236-712a-ae51-98301647844c","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"setvar  [{\"A10\":\"Año\", \"B10\":\"Valor Máx\", \"C10\":\"Valor Min\", \"D10\":\"Promedio\", \"E10\":\"Mes Máx\", \"F10\":\"Mes Min\"}]","extra":[],"result":"True","description":"Se establece el encabezado de las columnas que tienen los datos por año"},{"father":"module","command":"{\"module_name\":\"AdvancedExcel\",\"module\":\"write_cell\",\"sheet\":\"Hoja1\",\"range\":\"A10\",\"data\":\"{encabezado}\"}","option":"","var":"","index":15,"group":"scripts","execute":2,"if":"","children":[],"else":[],"id":"f611a782-b727-11d4-6f71-900dbacea4f1","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"module  {\"module_name\":\"AdvancedExcel\",\"module\":\"write_cell\",\"sheet\":\"Hoja1\",\"range\":\"A10\",\"data\":\"{encabezado}\"}","extra":[],"result":"True","description":"Se escribe el diccionario con el encabzado de las columnas de los datos por año"},{"father":"module","command":"{\"module_name\":\"AdvancedExcel\",\"module\":\"write_cell\",\"sheet\":\"Hoja1\",\"range\":\"A11\",\"data\":\"{global_datos_agno}\"}","option":"","var":"","index":16,"group":"scripts","execute":2,"if":"","children":[],"else":[],"id":"b98b4db1-69f1-7081-215f-afa8bd497f80","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"module  {\"module_name\":\"AdvancedExcel\",\"module\":\"write_cell\",\"sheet\":\"Hoja1\",\"range\":\"A11\",\"data\":\"{global_datos_agno}\"}","extra":[],"result":"True","disabled":false,"description":"Se escriben los datos de los años. Variable global_datos_agno viene del robot padre"},{"father":"setVar","command":"False","option":"","var":"resultado","index":17,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"d4a63145-f434-6393-aff0-5774778a7204","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  \"C:/Users/jmunoz-hp/Documents/robot/Trazabilidad/2021_11_07_11_17_38.xlsx\"","extra":[],"result":"True","description":"Se establece a False la variable que permite evaluar si el libro se guardará correctamente"},{"father":"savexlsx","command":"{full_path}","option":"","var":"","index":18,"group":"excel","execute":2,"if":"","children":[],"else":[],"id":"98d1c6a5-7239-8aa2-7be9-8b4979d55552","mode_live":true,"getvar":"resultado","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"savexlsx  {full_path}","extra":false,"result":"True","description":"Se guarda el archivo escrito"},{"father":"evaluateIf","command":"{resultado}","option":"","var":"","index":19,"group":"logic","execute":2,"if":"","children":[{"father":"setVar","command":"\"{full_path}\"","option":"","var":"global_path_informe","index":0,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"b2ccb7aa-e215-eb56-999f-ff84942b7d9b","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  \"C:/Users/jmunoz-hp/Documents/robot/Trazabilidad/2021_11_07_11_17_38.xlsx\"","extra":[],"result":"True","description":"Se establece el valor de la variable del robot padre con la ruta comppleta del archivo generado"},{"father":"setVar","command":"True","option":"","var":"global_resultado_exec_robot","index":1,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"fdad89cf-4e0b-7b53-0355-ea79b22ff012","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","description":"Llegados a este punto, el robot se ha ejecutado correctamente. Se establece variable para que el padre pueda evaluar el resultado de la ejecución"},{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":2,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"c5d504a1-f69a-321a-337e-a59bb40a2a79","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  datetime.now().strftime(\"%Y_%m_%d_%H_%M_%S\")","extra":[],"result":"True","description":"Se estabkece marca de tiempo para escribir log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: El robot multivac_escribir_excel ha finalizado con éxito global_path_informe = {global_path_informe}, global_resultado_exec_robot = {global_resultado_exec_robot}\"}","option":"","var":"","index":3,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"d84f930c-fc98-7707-bcf7-8055e1cd5f45","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe log"}],"else":[{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":0,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"1d69dc12-c761-4e98-4fcc-1468304b21bc","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  datetime.now().strftime(\"%Y_%m_%d_%H_%M_%S\")","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Ocurrió un error al tratar de guardar el archivo del informe. Terminando robot multivac_escribir_excel global_resultado_exec_robot = {global_resultado_exec_robot}\"}","option":"","var":"","index":1,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"4a213a91-8441-7fda-cd64-59846d4eb7ca","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe log en caso de que no se pueda guardar el archivo abierto"}],"id":"0870f2c8-659d-4741-6f3a-0985a670823b","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Si se guardó correctamente el archivo..."},{"father":"quitexcel","command":"","option":"","var":"","index":20,"group":"excel","execute":2,"if":"","children":[],"else":[],"id":"9dbb54c0-f276-1c95-4a42-9ebe05704112","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"quitexcel  ","extra":false,"result":"True","description":"Se cierra el Excel abierto"}],"else":[{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":0,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"b37b2717-bdb4-f9c8-2966-b2edd6ce9f48","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  datetime.now().strftime(\"%Y_%m_%d_%H_%M_%S\")","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Ocurrió un error al tratar de abrir Excel para genrar el archivo del informe. Terminando robot multivac_escribir_excel global_resultado_exec_robot = {global_resultado_exec_robot}\"}","option":"","var":"","index":1,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"07591fcc-43da-cb7b-ec33-3ad9b8e6b291","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe log en caso de error de que no se haya podido crear el libro de Excel"}],"id":"58c002d4-1861-8ff7-0462-4c22e7b1dcec","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","minimize":false,"minimize_else":false,"execute_debbug":0,"img":"","description":"Si se creó exitosamente el libro de excel..."}],"else":[{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":0,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"72f04f7b-b37e-a8c8-0f48-d95b1a181dfd","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  datetime.now().strftime(\"%Y_%m_%d_%H_%M_%S\")","extra":[],"result":"True","description":"Se crea marca de tiempo para escribir log"},{"father":"last_status","command":"{ultimo_estado}","option":"","var":"","index":1,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"ef9bd7df-699c-24d4-2332-5864351a160c","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":""},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Se produjo una excepción el bloque de instrucciones que intentan abrir Excel, escribir los datos en el archivo y guardar el libro. Terminando robot multivac_escribir_excel global_resultado_exec_robot = {global_resultado_exec_robot} {ultimo_estado}\"}","option":"","var":"","index":2,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"9a1d6ed1-cadf-e7f3-7170-0a45de25e781","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe log en caso de que se produzca euna excepción en la soperaciones de crear el libro de excel, escibir datos y guardar el libro de excel"}],"id":"a21e0ab3-beea-a8ac-32d4-baba2dadc284","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Bloque Try-Catch para intentar abirir excel y escribir la información en un nuevo libro"}],"vars":[{"name":"resultado","data":"","type":"string","collapse":true,"$$hashKey":"object:462"},{"name":"marca_tiempo","data":"","type":"string","collapse":true,"$$hashKey":"object:463"},{"name":"nombre_archivo","data":"","type":"string","collapse":true,"$$hashKey":"object:464"},{"name":"full_path","data":"","type":"string","collapse":true,"$$hashKey":"object:465"},{"name":"indice_variable","data":"","type":"string","collapse":true,"$$hashKey":"object:466"},{"name":"path_dir_trazabilidad","data":"","type":"string","collapse":true,"$$hashKey":"object:467"},{"name":"encabezado","data":"","type":"string","collapse":true,"$$hashKey":"object:468"},{"name":"fecha_inicial_informe","data":"","type":"string","collapse":true,"$$hashKey":"object:469"},{"name":"fecha_final_informe","data":"","type":"string","collapse":true,"$$hashKey":"object:470"},{"name":"trm_dia","data":"","type":"string","collapse":true,"$$hashKey":"object:471"},{"name":"texto_celda","data":"","type":"string","collapse":true,"$$hashKey":"object:472"},{"name":"log_file","data":"","type":"string","collapse":true,"$$hashKey":"object:473"},{"name":"marca_tiempo_log","data":"","type":"string","collapse":true,"$$hashKey":"object:474"},{"name":"ultimo_estado","data":"","type":"string","collapse":true,"$$hashKey":"object:475"}],"ifs":[{"id":"c09b8b75-e00e-b8a8-f35f-23479a536e83","status":null},{"id":"70aaa433-6ff1-0c20-d406-2f324ed48f2e","status":null}]}}