{"project":{"profile":{"name":"multivac_enviar_correo","description":"Robot para enviar por correo el informe del análisis TRM generado"},"commands":[{"father":"module","command":"{\"module_name\":\"System++\",\"module\":\"cleanVars\",\"vars\":\"indice_variable,passwd_correo,destinatario_informe,asunto_correo,servidor_smtp,puerto_smtp,usuario_correo,marca_tiempo_log,log_file,resultado\"}","option":"","var":"","index":0,"group":"scripts","execute":2,"if":"","children":[],"else":[],"id":"55d23550-60df-4ed9-e32a-f7c7de383599","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","description":"Se limpian las variables locales de este robot"},{"father":"setVar","command":"False","option":"","var":"global_resultado_exec_robot","index":1,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"d37f3bb5-49db-f22f-ed4f-d33c34af56d5","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  False","extra":[],"result":"True","description":"Se establece en False variable con la que el robot padre evalúa si este robot se ejecutó correctamente"},{"father":"setVar","command":"{variables_conf}.index(['path_dir_logs'])","option":"","var":"indice_variable","index":2,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"a8527da5-6a74-6ad3-1242-957b0cb15ba9","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"name 'variables_conf' is not defined","extra":[],"result":"False","description":"Se obtiene el índice de la variable de configuración path_dir_logs"},{"father":"setVar","command":"{valores_conf}[{indice_variable}][0] + \"/log.txt\"","option":"","var":"log_file","index":3,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"a658b71e-b2b1-a055-6b5e-b5c36aeee870","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['fecha_inicial_informe'], ['fecha_final_informe'], ['usuario_correo'], ['passwd_correo'], ['destinatario_informe'], ['asunto_correo'], ['servidor_smtp'], ['puerto_smtp'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_boton_aceptar'], ['xpath_link_exportar'], ['xpath_exportar_datos'], ['xpath_exportar_csv'], ['path_dir_recibidos'], ['path_dir_logs'], ['path_dir_trazabilidad']].index(['usuario_correo'])","extra":[],"result":"True","description":"Se establece la ruta completa al archivo de log"},{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":4,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"f19f1fcc-3b3b-89d6-ecc7-b34376f98b25","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['fecha_inicial_informe'], ['fecha_final_informe'], ['usuario_correo'], ['passwd_correo'], ['destinatario_informe'], ['asunto_correo'], ['servidor_smtp'], ['puerto_smtp'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_boton_aceptar'], ['xpath_link_exportar'], ['xpath_exportar_datos'], ['xpath_exportar_csv'], ['path_dir_recibidos'], ['path_dir_logs'], ['path_dir_trazabilidad']].index(['usuario_correo'])","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"=======O=======\\n{marca_tiempo_log}: Ahora estoy ejecutando el robot multivac_enviar_correo\"}","option":"","var":"","index":5,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"abb72e55-dfff-86d4-5cd6-a86df99461d8","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe log"},{"father":"setVar","command":"{variables_conf}.index(['usuario_correo'])","option":"","var":"indice_variable","index":6,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"3d59c98d-cba9-d3b8-fbdf-e32373fb42d8","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['fecha_inicial_informe'], ['fecha_final_informe'], ['usuario_correo'], ['passwd_correo'], ['destinatario_informe'], ['asunto_correo'], ['servidor_smtp'], ['puerto_smtp'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_boton_aceptar'], ['xpath_link_exportar'], ['xpath_exportar_datos'], ['xpath_exportar_csv'], ['path_dir_recibidos'], ['path_dir_logs'], ['path_dir_trazabilidad']].index(['usuario_correo'])","extra":[],"result":"True","description":"Se obtiene el índice de la variable de configuración usuario_correo"},{"father":"setVar","command":"{valores_conf}[{indice_variable}][0]","option":"","var":"usuario_correo","index":7,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"821980d4-e0aa-60a2-f115-e398cadc69e2","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['\"01/01/2015\"'], ['\"06/11/2021\"'], ['pedrogamborena@gmail.com'], ['Apaporis2905'], ['pedrogamborena@gmail.com'], ['Mutivac informe diario TRM'], ['smtp.gmail.com'], [465], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[5]/td/input'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[5]'], ['/html/body/div[2]/table/tbody/tr[1]/td[1]/a[2]'], ['C:/Users/jmunoz-hp/Documents/robot/Recibidos'], ['C:/Users/jmunoz-hp/Documents/robot/Logs'], ['C:/Users/jmunoz-hp/Documents/robot/Trazabilidad']][10][0]","extra":[],"result":"True","description":"Se establece la variable usuario_correo"},{"father":"setVar","command":"{variables_conf}.index(['passwd_correo'])","option":"","var":"indice_variable","index":8,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"4912f477-26bd-75c6-2b02-d5893b1ea8dd","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['fecha_inicial_informe'], ['fecha_final_informe'], ['usuario_correo'], ['passwd_correo'], ['destinatario_informe'], ['asunto_correo'], ['servidor_smtp'], ['puerto_smtp'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_boton_aceptar'], ['xpath_link_exportar'], ['xpath_exportar_datos'], ['xpath_exportar_csv'], ['path_dir_recibidos'], ['path_dir_logs'], ['path_dir_trazabilidad']].index(['passwd_correo'])","extra":[],"result":"True","description":"Se obtiene el índice de la variablle configuración passwd_correo"},{"father":"setVar","command":"{valores_conf}[{indice_variable}][0]","option":"","var":"passwd_correo","index":9,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"09d294eb-d10d-4bf5-e565-49f1a0b65e19","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['\"01/01/2015\"'], ['\"06/11/2021\"'], ['pedrogamborena@gmail.com'], ['Apaporis2905'], ['pedrogamborena@gmail.com'], ['Mutivac informe diario TRM'], ['smtp.gmail.com'], [465], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[5]/td/input'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[5]'], ['/html/body/div[2]/table/tbody/tr[1]/td[1]/a[2]'], ['C:/Users/jmunoz-hp/Documents/robot/Recibidos'], ['C:/Users/jmunoz-hp/Documents/robot/Logs'], ['C:/Users/jmunoz-hp/Documents/robot/Trazabilidad']][11][0]","extra":[],"result":"True","description":"Se establece la variable passwd_correo"},{"father":"setVar","command":"{variables_conf}.index(['destinatario_informe'])","option":"","var":"indice_variable","index":10,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"1902d35a-ec62-9c83-41e0-849f2506e802","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['fecha_inicial_informe'], ['fecha_final_informe'], ['usuario_correo'], ['passwd_correo'], ['destinatario_informe'], ['asunto_correo'], ['servidor_smtp'], ['puerto_smtp'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_boton_aceptar'], ['xpath_link_exportar'], ['xpath_exportar_datos'], ['xpath_exportar_csv'], ['path_dir_recibidos'], ['path_dir_logs'], ['path_dir_trazabilidad']].index(['destinatario_informe'])","extra":[],"result":"True","description":"Se obtiene el índice de la variable de configuración destinatario_informe"},{"father":"setVar","command":"{valores_conf}[{indice_variable}][0]","option":"","var":"destinatario_informe","index":11,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"ff272511-dda3-dc7f-762f-c75694be1168","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['\"01/01/2015\"'], ['\"06/11/2021\"'], ['pedrogamborena@gmail.com'], ['Apaporis2905'], ['pedrogamborena@gmail.com'], ['Mutivac informe diario TRM'], ['smtp.gmail.com'], [465], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[5]/td/input'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[5]'], ['/html/body/div[2]/table/tbody/tr[1]/td[1]/a[2]'], ['C:/Users/jmunoz-hp/Documents/robot/Recibidos'], ['C:/Users/jmunoz-hp/Documents/robot/Logs'], ['C:/Users/jmunoz-hp/Documents/robot/Trazabilidad']][12][0]","extra":[],"result":"True","description":"Se establece el valor de la variable destinatario_informe"},{"father":"setVar","command":"{variables_conf}.index(['asunto_correo'])","option":"","var":"indice_variable","index":12,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"7c3244d4-f6c7-f742-bd13-e235acd9a42b","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['fecha_inicial_informe'], ['fecha_final_informe'], ['usuario_correo'], ['passwd_correo'], ['destinatario_informe'], ['asunto_correo'], ['servidor_smtp'], ['puerto_smtp'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_boton_aceptar'], ['xpath_link_exportar'], ['xpath_exportar_datos'], ['xpath_exportar_csv'], ['path_dir_recibidos'], ['path_dir_logs'], ['path_dir_trazabilidad']].index(['asunto_correo'])","extra":[],"result":"True","description":"Se obtiene el índice de la variable de configuración asunto_correo"},{"father":"setVar","command":"{valores_conf}[{indice_variable}][0]","option":"","var":"asunto_correo","index":13,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"c8023df7-d1da-d372-7823-b30d624891e3","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['\"01/01/2015\"'], ['\"06/11/2021\"'], ['pedrogamborena@gmail.com'], ['Apaporis2905'], ['pedrogamborena@gmail.com'], ['Mutivac informe diario TRM'], ['smtp.gmail.com'], [465], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[5]/td/input'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[5]'], ['/html/body/div[2]/table/tbody/tr[1]/td[1]/a[2]'], ['C:/Users/jmunoz-hp/Documents/robot/Recibidos'], ['C:/Users/jmunoz-hp/Documents/robot/Logs'], ['C:/Users/jmunoz-hp/Documents/robot/Trazabilidad']][13][0]","extra":[],"result":"True","description":"Se establece el valor de la variable asunto_correo"},{"father":"setVar","command":"{variables_conf}.index(['servidor_smtp'])","option":"","var":"indice_variable","index":14,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"63db96e1-0531-c92a-1072-36193a1e6349","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['fecha_inicial_informe'], ['fecha_final_informe'], ['usuario_correo'], ['passwd_correo'], ['destinatario_informe'], ['asunto_correo'], ['servidor_smtp'], ['puerto_smtp'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_boton_aceptar'], ['xpath_link_exportar'], ['xpath_exportar_datos'], ['xpath_exportar_csv'], ['path_dir_recibidos'], ['path_dir_logs'], ['path_dir_trazabilidad']].index(['servidor_smtp'])","extra":[],"result":"True","description":"Se obtiene el índice de la variable de configuración servidor_smtp"},{"father":"setVar","command":"{valores_conf}[{indice_variable}][0]","option":"","var":"servidor_smtp","index":15,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"f442f425-01ad-365e-a5c2-d68069638741","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['\"01/01/2015\"'], ['\"06/11/2021\"'], ['pedrogamborena@gmail.com'], ['Apaporis2905'], ['pedrogamborena@gmail.com'], ['Mutivac informe diario TRM'], ['smtp.gmail.com'], [465], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[5]/td/input'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[5]'], ['/html/body/div[2]/table/tbody/tr[1]/td[1]/a[2]'], ['C:/Users/jmunoz-hp/Documents/robot/Recibidos'], ['C:/Users/jmunoz-hp/Documents/robot/Logs'], ['C:/Users/jmunoz-hp/Documents/robot/Trazabilidad']][14][0]","extra":[],"result":"True","description":"Se establece el valor de la variable servidor_smtp"},{"father":"setVar","command":"{variables_conf}.index(['puerto_smtp'])","option":"","var":"indice_variable","index":16,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"6df2f2ac-1bba-522a-dc34-fcc30c8f3fe0","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['fecha_inicial_informe'], ['fecha_final_informe'], ['usuario_correo'], ['passwd_correo'], ['destinatario_informe'], ['asunto_correo'], ['servidor_smtp'], ['puerto_smtp'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_boton_aceptar'], ['xpath_link_exportar'], ['xpath_exportar_datos'], ['xpath_exportar_csv'], ['path_dir_recibidos'], ['path_dir_logs'], ['path_dir_trazabilidad']].index(['puerto_smtp'])","extra":[],"result":"True","description":"Se obtiene el índice de la variable de configuración puerto_smtp"},{"father":"setVar","command":"{valores_conf}[{indice_variable}][0]","option":"","var":"puerto_smtp","index":17,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"1711352b-f56f-331e-95ad-2ec500d9f829","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['C:\\\\Users\\\\jmunoz-hp\\\\Documents\\\\robot'], ['E:\\\\Users\\\\jmunoz\\\\Downloads'], ['Base'], ['Recibidos'], ['Logs'], ['Trazabilidad'], ['https://www.banrep.gov.co/'], ['https://www.banrep.gov.co/es/estadisticas/trm'], ['\"01/01/2015\"'], ['\"06/11/2021\"'], ['pedrogamborena@gmail.com'], ['Apaporis2905'], ['pedrogamborena@gmail.com'], ['Mutivac informe diario TRM'], ['smtp.gmail.com'], [465], ['/html/body/div[3]/div[3]/section/section/div/div/div[2]/iframe'], ['/html/body/table[2]/tbody/tr[1]/td/div'], ['/html/body/div[3]/main/div/div/div[1]/div[1]/ul/li[1]/span/a'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[4]/td/table/tbody/tr/td/table/tbody/tr/td/table/tbody/tr[2]/td/span/span[2]/span/input'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td/div/form/div/table/tbody/tr[5]/td/input'], ['/html/body/table/tbody/tr/td/div/table/tbody/tr/td[5]/a'], ['/html/body/div/table/tbody/tr[1]/td[1]/a[5]'], ['/html/body/div[2]/table/tbody/tr[1]/td[1]/a[2]'], ['C:/Users/jmunoz-hp/Documents/robot/Recibidos'], ['C:/Users/jmunoz-hp/Documents/robot/Logs'], ['C:/Users/jmunoz-hp/Documents/robot/Trazabilidad']][15][0]","extra":[],"result":"True","description":"Se establece el valor de la variable puerto_smtp"},{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":18,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"772ee2a8-c059-65e9-5a54-0ab1d75d243d","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['fecha_inicial_informe'], ['fecha_final_informe'], ['usuario_correo'], ['passwd_correo'], ['destinatario_informe'], ['asunto_correo'], ['servidor_smtp'], ['puerto_smtp'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_boton_aceptar'], ['xpath_link_exportar'], ['xpath_exportar_datos'], ['xpath_exportar_csv'], ['path_dir_recibidos'], ['path_dir_logs'], ['path_dir_trazabilidad']].index(['usuario_correo'])","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Iniciando multivac_enviar_correo con las siguientes variables usuario_correo = {usuario_correo}, destinatario_informe = {destinatario_informe}, asunto_correo = {asunto_correo}, servidor_smtp = {servidor_smtp}, puerto_smtp = {puerto_smtp}\"}","option":"","var":"","index":19,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"17fad458-e1d1-5d40-f0c6-00d57b4a59a5","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe log"},{"father":"evaluateIf","command":"len(\"{usuario_correo}\".strip()) == 0 or len(\"{passwd_correo}\".strip()) == 0 or len(\"{destinatario_informe}\".strip()) == 0 or len(\"{asunto_correo}\".strip()) == 0 or len(\"{servidor_smtp}\".strip()) == 0 or len(\"{puerto_smtp}\".strip()) == 0","option":"","var":"","index":20,"group":"logic","execute":2,"if":"","children":[{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":0,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"f51160e5-98a4-302b-4d87-5b9237b3432a","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['fecha_inicial_informe'], ['fecha_final_informe'], ['usuario_correo'], ['passwd_correo'], ['destinatario_informe'], ['asunto_correo'], ['servidor_smtp'], ['puerto_smtp'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_boton_aceptar'], ['xpath_link_exportar'], ['xpath_exportar_datos'], ['xpath_exportar_csv'], ['path_dir_recibidos'], ['path_dir_logs'], ['path_dir_trazabilidad']].index(['usuario_correo'])","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: No se puede ejecutar el robot multivac_enviar_correo debido a que faltan parámetros de configuración de correo: usuario_correo = {usuario_correo}, destinatario_informe = {destinatario_informe}, asunto_correo = {asunto_correo}, servidor_smtp = {servidor_smtp}, puerto_smtp = {puerto_smtp}, global_path_informe = {global_path_informe }\"}","option":"","var":"","index":1,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"fac876c7-bbf6-f5d7-6c8c-b2823e239962","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe log"}],"else":[{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":0,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"ff479499-eb16-7974-c955-fda5ee186c79","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['fecha_inicial_informe'], ['fecha_final_informe'], ['usuario_correo'], ['passwd_correo'], ['destinatario_informe'], ['asunto_correo'], ['servidor_smtp'], ['puerto_smtp'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_boton_aceptar'], ['xpath_link_exportar'], ['xpath_exportar_datos'], ['xpath_exportar_csv'], ['path_dir_recibidos'], ['path_dir_logs'], ['path_dir_trazabilidad']].index(['usuario_correo'])","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Configurando servidor de correo\"}","option":"","var":"","index":1,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"87d61e08-93e9-187f-fb99-53750a75477c","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe log"},{"father":"configemail","command":"{\"smtp\":\"{servidor_smtp}\",\"imap\":\"imap.gmail.com\",\"user\":\"{usuario_correo}\",\"pass\":\"{passwd_correo}\",\"smtp_port\":\"{puerto_smtp}\",\"imap_port\":993,\"ssl\":true,\"imap_ssl\":true}","option":"","var":"","index":2,"group":"email","execute":2,"if":"","children":[],"else":[],"id":"df1df155-1e4c-f1e0-95da-6685eb8f0a3a","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","message":"(235, b'2.7.0 Accepted')","extra":[],"result":"True","description":"Se configura servidor de correo con los parámetros obtenidos desde el archivo de configuración"},{"father":"last_status","command":"{resultado}","option":"","var":"","index":3,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"375763f7-7e19-c91c-d152-6b63bb6e2844","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se obtiene l último estado para saber si se configuró exitosamente el correo"},{"father":"evaluateIf","command":"{resultado}['status'] == \"True\"","option":"","var":"","index":4,"group":"logic","execute":2,"if":"","else":[{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":0,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"eb2b8d4e-5366-811d-cc2e-5ef15273c95d","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['fecha_inicial_informe'], ['fecha_final_informe'], ['usuario_correo'], ['passwd_correo'], ['destinatario_informe'], ['asunto_correo'], ['servidor_smtp'], ['puerto_smtp'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_boton_aceptar'], ['xpath_link_exportar'], ['xpath_exportar_datos'], ['xpath_exportar_csv'], ['path_dir_recibidos'], ['path_dir_logs'], ['path_dir_trazabilidad']].index(['usuario_correo'])","extra":[],"result":"True","description":"Se estabkece marca de tiempo para escribir log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Ocurrió un error al tratar de configurar el servidor de correo SMTP resultado = {resultado}\"}","option":"","var":"","index":1,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"a9fd1606-b565-244a-3e6e-7e6f6c737e01","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe log en caso de que no se haya configurado correctamente el servidor de correo"}],"id":"14480e75-1297-3c93-6c26-1bd89b74b164","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","children":[{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":0,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"cc9fdddb-e92b-590d-6633-9e37c01a991a","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['fecha_inicial_informe'], ['fecha_final_informe'], ['usuario_correo'], ['passwd_correo'], ['destinatario_informe'], ['asunto_correo'], ['servidor_smtp'], ['puerto_smtp'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_boton_aceptar'], ['xpath_link_exportar'], ['xpath_exportar_datos'], ['xpath_exportar_csv'], ['path_dir_recibidos'], ['path_dir_logs'], ['path_dir_trazabilidad']].index(['usuario_correo'])","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir archivo de log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Enviando mensaje de correo\"}","option":"","var":"","index":1,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"5783af7d-697c-765a-54f4-d0fe702b4090","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe archivo de log"},{"father":"sendemail","command":"{\"to\":\"{destinatario_informe}\",\"subject\":\"{asunto_correo}\",\"msg\":\"Informe diario análisis TRM\",\"file\":\"{global_path_informe}\"}","option":"","var":"","index":2,"group":"email","execute":2,"if":"","children":[],"else":[],"id":"e427d992-ad9d-e7e3-28fd-2c66ddad2f99","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se envía el mensaje de correo con los valores obtenidos en las variables indicadas"},{"father":"last_status","command":"{resultado}","option":"","var":"","index":3,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"d3332599-4df2-e7b8-a3de-3c3086508a26","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se obtiene el resultado del envío de correo"},{"father":"evaluateIf","command":"{resultado}['status'] == \"True\"","option":"","var":"","index":4,"group":"logic","execute":2,"if":"","children":[{"father":"setVar","command":"True","option":"","var":"global_resultado_exec_robot","index":0,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"1c2ad07a-b502-3bc2-22e8-6eb1b005b859","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se establece la variable global que indica al robot padre que este robot ha hecho bien su trabajo"},{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":1,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"5e3d1a43-29c2-c72d-e14d-6ec4c6207463","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['fecha_inicial_informe'], ['fecha_final_informe'], ['usuario_correo'], ['passwd_correo'], ['destinatario_informe'], ['asunto_correo'], ['servidor_smtp'], ['puerto_smtp'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_boton_aceptar'], ['xpath_link_exportar'], ['xpath_exportar_datos'], ['xpath_exportar_csv'], ['path_dir_recibidos'], ['path_dir_logs'], ['path_dir_trazabilidad']].index(['usuario_correo'])","extra":[],"result":"True","description":"Se establece marca de tiempom para escribir log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Robot multivac_enviar_correo finalizado con éxito global_resultado_exec_robot = {global_resultado_exec_robot}\"}","option":"","var":"","index":2,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"cb548804-595c-11e8-bcfa-6685dcc6da11","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe log"}],"else":[{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":0,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"602c4eb4-07e6-b06b-474f-5b9f209a7a97","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['fecha_inicial_informe'], ['fecha_final_informe'], ['usuario_correo'], ['passwd_correo'], ['destinatario_informe'], ['asunto_correo'], ['servidor_smtp'], ['puerto_smtp'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_boton_aceptar'], ['xpath_link_exportar'], ['xpath_exportar_datos'], ['xpath_exportar_csv'], ['path_dir_recibidos'], ['path_dir_logs'], ['path_dir_trazabilidad']].index(['usuario_correo'])","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Ocurrió un error al tratar de enviar el mensaje de correo resultado = {resultado}\"}","option":"","var":"","index":1,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"62252471-0322-df84-059d-d026ee555d42","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe log en caso de que haya ocurrido un error en el envío del mensaje"}],"id":"d1b6b55f-f6fb-0724-8b52-80c2974bf48a","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","minimize":false,"execute_debbug":0,"img":"","description":"Se si envía satisfactoriamente el correo..."}],"minimize":false,"execute_debbug":0,"img":"","description":"Si el servidor fue configurado correctamente..."}],"id":"0ad2e1b0-7f1a-423c-3ab5-5a61330d6dd6","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se evalúa si existen valores para los parámetros básicos de configuración de cortreo electrónico"},{"father":"setVar","command":"datetime.now().strftime(\"%Y-%m-%d %H:%M:%S\")","option":"","var":"marca_tiempo_log","index":21,"group":"system","execute":2,"if":"","children":[],"else":[],"id":"8264fbf8-876d-855d-e069-b63603a0b457","mode_live":true,"getvar":"","screenshot":"","execute_debbug":0,"img":"","message":"setvar  [['dir_robot'], ['dir_descargas'], ['dir_base'], ['dir_recibidos'], ['dir_logs'], ['dir_trazabilidad'], ['url_trm_dia'], ['url_informe'], ['fecha_inicial_informe'], ['fecha_final_informe'], ['usuario_correo'], ['passwd_correo'], ['destinatario_informe'], ['asunto_correo'], ['servidor_smtp'], ['puerto_smtp'], ['xpath_iframe_trm'], ['xpath_trm_dia'], ['xpath_link_informe'], ['xpath_fecha_inicial'], ['xpath_boton_aceptar'], ['xpath_link_exportar'], ['xpath_exportar_datos'], ['xpath_exportar_csv'], ['path_dir_recibidos'], ['path_dir_logs'], ['path_dir_trazabilidad']].index(['usuario_correo'])","extra":[],"result":"True","description":"Se establece marca de tiempo para escribir log"},{"father":"savedatafile","command":"{\"file_name\":\"{log_file}\",\"type\":\"add\",\"new_line\":true,\"file_data\":\"{marca_tiempo_log}: Finalizando robot multivac_enviar_correo global_resultado_exec_robot = {global_resultado_exec_robot}\"}","option":"","var":"","index":22,"group":"file","execute":2,"if":"","children":[],"else":[],"id":"d943def5-0f43-7eed-27fe-878d53490369","mode_live":true,"getvar":"","extra_data":null,"screenshot":"","execute_debbug":0,"img":"","description":"Se escribe archivo de log para indicar que este robort finalizó"}],"vars":[{"name":"indice_variable","data":"15","type":"string","collapse":true,"$$hashKey":"object:462"},{"name":"passwd_correo","data":"Apaporis2905","type":"password","collapse":true,"$$hashKey":"object:463"},{"name":"destinatario_informe","data":"pedrogamborena@gmail.com","type":"string","collapse":true,"$$hashKey":"object:464"},{"name":"asunto_correo","data":"Mutivac informe diario TRM","type":"string","collapse":true,"$$hashKey":"object:465"},{"name":"servidor_smtp","data":"smtp.gmail.com","type":"string","collapse":true,"$$hashKey":"object:466"},{"name":"puerto_smtp","data":"465","type":"string","collapse":true,"$$hashKey":"object:467"},{"name":"usuario_correo","data":"pedrogamborena@gmail.com","type":"string","collapse":true,"$$hashKey":"object:468"},{"name":"marca_tiempo_log","data":"","type":"string","collapse":true,"$$hashKey":"object:469"},{"name":"log_file","data":"","type":"string","collapse":true,"$$hashKey":"object:470"},{"name":"resultado","data":"{'status': 'True', 'message': 'last_status  {r}', 'img': '', 'vars': [{'name': 'indice_variable', 'data': '15', 'type': 'string', 'collapse': True, '$$hashKey': 'object:3694'}, {'name': 'passwd_correo', 'data': 'Apaporis2905', 'type': 'password', 'collapse': True, '$$hashKey': 'object:3695'}, {'name': 'destinatario_informe', 'data': 'pedrogamborena@gmail.com', 'type': 'string', 'collapse': True, '$$hashKey': 'object:3696'}, {'name': 'asunto_correo', 'data': 'Mutivac informe diario TRM', 'type': 'string', 'collapse': True, '$$hashKey': 'object:3697'}, {'name': 'servidor_smtp', 'data': 'smtp.gmail.com', 'type': 'string', 'collapse': True, '$$hashKey': 'object:3698'}, {'name': 'puerto_smtp', 'data': '465', 'type': 'string', 'collapse': True, '$$hashKey': 'object:3699'}, {'name': 'usuario_correo', 'data': 'pedrogamborena@gmail.com', 'type': 'string', 'collapse': True, '$$hashKey': 'object:3700'}, {'name': 'marca_tiempo_log', 'data': '', 'type': 'string', 'collapse': True, '$$hashKey': 'object:3701'}, {'name': 'log_file', 'data': '', 'type': 'string', 'collapse': True, '$$hashKey': 'object:3702'}, {'name': 'resultado', 'data': '', 'type': 'string', 'collapse': True, '$$hashKey': 'object:3703'}], 'ifs': [], 'extra': []}","type":"string","collapse":true,"$$hashKey":"object:471"}],"ifs":[{"id":"4f0a35b9-3c24-553e-f54b-39cf04c3cd82","status":null},{"id":"17fb46bb-58f7-7ab9-ce34-3816cb520057","status":null},{"id":"a0ffb421-eb31-a2a4-dbfc-22f6a5dda777","status":null},{"id":"d5676be1-edd0-d39d-07ea-0d18816bb879","status":null},{"id":"0dc6b0bd-b52b-5e24-2aec-ad311f679acc","status":null},{"id":"a5d7fbf6-452d-6e6d-c885-b8fe8c57efdc","status":null},{"id":"25e3fee6-a597-08f2-977e-16cf0087a275","status":null}]}}